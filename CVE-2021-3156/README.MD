# CVE-2021-3156
https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-3156

## Description:
Sudo before 1.9.5p2 contains an off-by-one error that can result in a heap-based buffer overflow, which allows privilege escalation to root via "sudoedit -s" and a command-line argument that ends with a single backslash character. PoC for [CVE-2021-3156](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3156) (sudo heap overflow). Exploit by @gf_256 aka cts. Thanks to r4j from super guesser for help and debug and more tests from [nu11secur1ty](https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-3156/1.30.2021). Credit to Braon Samedit of Qualys for the [original advisory](https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt).

## Patch:
[href](https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-3156/sohoshi)

# Download the latest version
https://www.sudo.ws/download.html

- - - Building 

https://www.sudo.ws/packaging.html

- - - video

https://www.youtube.com/watch?v=zf8FXOFWZKs

- - - m0r# and fix =) 

https://www.youtube.com/watch?v=2_ZaNBl6qNo

- - - Testing OS

https://releases.ubuntu.com/17.10/

https://releases.ubuntu.com/18.04/

https://releases.ubuntu.com/18.04.1/

https://releases.ubuntu.com/19.04/ - still vulnerable

https://releases.ubuntu.com/20.04/

----------------------------------------------------------------------------------------------

- - - Online checking for vulnerabilities

```bash 
curl -s https://raw.githubusercontent.com/nu11secur1ty/CVE-mitre/main/CVE-2021-3156/sohoshi/sohoshi.sh | bash
```

- - - Online upgrade
- WARNING: `sudo` account should be enabled!

```bash 
curl -s https://raw.githubusercontent.com/nu11secur1ty/CVE-mitre/main/CVE-2021-3156/sohoshi/sohoshi_upgrade.sh | bash
```
# BR nu11secur1ty
