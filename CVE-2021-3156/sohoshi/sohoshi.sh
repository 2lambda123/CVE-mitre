#!/usr/bin/bash
# @nu11secur1ty
# CVE-2021-3156 Vulnerability checker by nu11secur1ty
# ---------------------------------------------------
# Sudo before 1.9.5p2 has a Heap-based Buffer Overflow, allowing privilege escalation to root via "sudoedit -s" 
# and a command-line argument that ends with a single backslash character.
# sudoedit -s '1234567890123456789 \'
while ! sudoedit -s '\' `perl -e 'print "A" x 65536'`
do
    echo -e "\e[31mIf you see (core dumped) or (memory corruption) then your Sudo version is vulnerable from Buffer Overflow - privilege escalation attack...\e[0m" 
    echo -e "\e[31mYou should UPGRADE YOUR SYSTEM and your sudo version to the latest or (1.9.5p2)!!!\e[0m"
    echo -e "\e[35mOr copy and paste the command directly from here ;) curl -s https://raw.githubusercontent.com/nu11secur1ty/CVE-mitre/main/CVE-2021-3156/sohoshi/sohoshi_upgrade.sh | bash\e[0m"
    
        # put your exploitation code here and customize the break.. ;)
    
    break;
        exit 0;
done
