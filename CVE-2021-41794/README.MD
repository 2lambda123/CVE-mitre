## [CVE-2021-41794]()
## Description:

```
Vendor: Open5GS
Vendor URL: https://github.com/open5gs/open5gs
Versions affected: 1.0.0 to 2.3.3
Systems Affected: Linux
Author: mark.tedman[at]nccgroup[dot]com
Advisory URL / CVE Identifier: CVE-2021-41794
Risk: CVSSv3.1: 8.2 (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H)
```

Summary
When connecting to the UPF port for the PFCP protocol (8805) and sending an Association Setup Request followed by a Session Establishment Request with a PDI Network Instance set to ‘internet’, it causes a stack corruption to occur.

Impact
Exploitation of this vulnerability would lead to denial of service for the subscriber’s equipment.

Details
Sending a PFCP Association Setup followed by a PFCP Session Establishment Request with the settings detailed below is enough to cause the stack overflow.  The issue is caused by the function ogs_fqdn_parse in the file lib/core/ogs-3gpp-types.c calculating a length value used in a memcpy without validating it.

Directly affected files:
```
Function: ogs_fqdn_parse in /lib/core/ogs-3gpp-types.c
/lib/nas/5gs/ies.c
/lib/nas/eps/ies.c
/lib/pfcp/handler.c
/lib/pfcp/types.c
/lib/sbi/nnrf-handler.c
/src/mme/sgsap-handler.c
/src/sgwc/s11-handler.c
/src/smf/context.c
```
The following python script can be used to replicate the issue:
