## CVE-2021-33470
- stupid in `login.php`
```php
if(isset($_POST['login']))
  {
    $uname=$_POST['username'];
    $Password=md5($_POST['inputpwd']);
    $query=mysqli_query($con,"select ID from tbladmin where  AdminuserName='$uname' && Password='$Password' ");
    $ret=mysqli_fetch_array($query);
    if($ret>0){
      $_SESSION['aid']=$ret['ID'];
     header('location:dashboard.php');
    }
```
- Proof: 
![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-33470/CVE-2021-33470.gif)

- Example of simple =) fix or you can write your own `function()` in `login.php` =)
```php
if(isset($_POST['login']))
  {
    $uname=$_POST['username'];
    $Password=md5($_POST['inputpwd']);
    $query = mysqli_query($con,("select ID from tbladmin where AdminuserName=(('$uname')) && Password=(('$Password'))" ));
    $ret = mysqli_fetch_array($query);
    if($ret>0){
      $_SESSION['aid']=$ret['ID'];
     header('location:dashboard.php');
    }
 ```
 - and `config.php`
 ```php
<?php
//time zone
date_default_timezone_set('Asia/Kolkata');

//database connection
$con=mysqli_connect("localhost","root","","covidtmsdb");

//Securing mysqli_connect =)
//by @nu11secur1ty
if(mysqli_connect_errno()){
echo "Connection Fail".mysqli_connect_error();
	$username = mysqli_real_escape_string($con, $_POST['username']);
mysqli_close($con);
}
	?>
 ```
![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-33470/CVE-2021-33470-simple-fix.gif)

THE PRICE OF THE FIX IS `4000$` =)
## =) BR
