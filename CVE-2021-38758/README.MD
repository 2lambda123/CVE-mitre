## Base on checks for other issues for [CVE-2021-38758](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38758) and I found SQL injection... :D
## Software version and [vendor](https://www.sourcecodester.com/php/14896/online-catering-reservation-system-using-php-free-source-code.html):
- - - Online-Catering-Reservation-DT Food Catering (by: oretnom23 ) v1.0
- Type `1=1`


[+] Vulnerable Code:

[+] Path: /catering/classes/Login.php

```php
		$qry = $this->conn->query("SELECT * from users where username = '$username' and password = md5('$password') ");
		if($qry->num_rows > 0){
			foreach($qry->fetch_array() as $k => $v){
				if(!is_numeric($k) && $k != 'password'){
					$this->settings->set_userdata($k,$v);
				}

			}
```

[+] Temporary fix of the problem, but not strong: :)
```php

		$qry = $this->conn->query("SELECT * from users where username = ('$username') and password = md5('$password') ");
		if($qry->num_rows > 0){
			foreach($qry->fetch_array() as $k => $v){
				if(!is_numeric($k) && $k != 'password'){
					$this->settings->set_userdata($k,$v);
				}

			}
```
- [Proof:](https://streamable.com/nidlqq)


![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-38758/docs/Capture.PNG)
- Proving and exploit the `critical` vulnerability: https://streamable.com/snk7v9
