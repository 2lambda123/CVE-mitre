## [CVE-2021-41054](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41054)

## Description:
tftpd_file.c in atftp through 0.7.4 has a buffer overflow because buffer-size handling does not properly consider the combination of data, OACK, and other options.

## Reproduce:

- Run `TestServ.sh`

```bash 
bash TestServ.sh
```
- Run `PoC-client.sh`

```bash
bash PoC-client.sh
```

## Test Output:
- `(core dumped)` /usr/sbin/atftpd
```bash
Oct 15 12:10:50 nu11secur1ty-dev atftpd[3276.140024667366976]: timeout option -> 3
Oct 15 12:10:50 nu11secur1ty-dev atftpd[3276.140024667366976]: blksize option -> 8
Oct 15 12:10:50 nu11secur1ty-dev atftpd[3276.140024667366976]: sent OACK <timeout: 3, blksize: 8>
TestServ.sh: line 8:  3276 Segmentation fault      (core dumped) /usr/sbin/atftpd --user=$(id -un) --group=$(id -gn) --daemon --no-fork --trace --logfile=/dev/stdout --verbose=7 --port 2000 tmp
Trace mode on.
Option blksize = 8
Usage: connect host-name [port]
Not connected.
```

